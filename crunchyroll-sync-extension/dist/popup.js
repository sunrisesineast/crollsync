/*! For license information please see popup.js.LICENSE.txt */
(()=>{function e(){var t,r,o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.toStringTag||"@@toStringTag";function c(e,o,s,a){var c=o&&o.prototype instanceof u?o:u,l=Object.create(c.prototype);return n(l,"_invoke",function(e,n,o){var s,a,c,u=0,l=o||[],d=!1,p={p:0,n:0,v:t,a:m,f:m.bind(t,4),d:function(e,n){return s=e,a=0,c=t,p.n=n,i}};function m(e,n){for(a=e,c=n,r=0;!d&&u&&!o&&r<l.length;r++){var o,s=l[r],m=p.p,f=s[2];e>3?(o=f===n)&&(c=s[(a=s[4])?5:(a=3,3)],s[4]=s[5]=t):s[0]<=m&&((o=e<2&&m<s[1])?(a=0,p.v=n,p.n=s[1]):m<f&&(o=e<3||s[0]>n||n>f)&&(s[4]=e,s[5]=n,p.n=f,a=0))}if(o||e>1)return i;throw d=!0,n}return function(o,l,f){if(u>1)throw TypeError("Generator is already running");for(d&&1===l&&m(l,f),a=l,c=f;(r=a<2?t:c)||!d;){s||(a?a<3?(a>1&&(p.n=-1),m(a,c)):p.n=c:p.v=c);try{if(u=2,s){if(a||(o="next"),r=s[o]){if(!(r=r.call(s,c)))throw TypeError("iterator result is not an object");if(!r.done)return r;c=r.value,a<2&&(a=0)}else 1===a&&(r=s.return)&&r.call(s),a<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),a=1);s=t}else if((r=(d=p.n<0)?c:e.call(n,p))!==i)break}catch(e){s=t,a=1,c=e}finally{u=1}}return{value:r,done:d}}}(e,s,a),!0),l}var i={};function u(){}function l(){}function d(){}r=Object.getPrototypeOf;var p=[][s]?r(r([][s]())):(n(r={},s,function(){return this}),r),m=d.prototype=u.prototype=Object.create(p);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,n(e,a,"GeneratorFunction")),e.prototype=Object.create(m),e}return l.prototype=d,n(m,"constructor",d),n(d,"constructor",l),l.displayName="GeneratorFunction",n(d,a,"GeneratorFunction"),n(m),n(m,a,"Generator"),n(m,s,function(){return this}),n(m,"toString",function(){return"[object Generator]"}),(e=function(){return{w:c,m:f}})()}function n(e,t,r,o){var s=Object.defineProperty;try{s({},"",{})}catch(e){s=0}n=function(e,t,r,o){function a(t,r){n(e,t,function(e){return this._invoke(t,r,e)})}t?s?s(e,t,{value:r,enumerable:!o,configurable:!o,writable:!o}):e[t]=r:(a("next",0),a("throw",1),a("return",2))},n(e,t,r,o)}function t(e,n,t,r,o,s,a){try{var c=e[s](a),i=c.value}catch(e){return void t(e)}c.done?n(i):Promise.resolve(i).then(r,o)}function r(e){return function(){var n=this,r=arguments;return new Promise(function(o,s){var a=e.apply(n,r);function c(e){t(a,o,s,c,i,"next",e)}function i(e){t(a,o,s,c,i,"throw",e)}c(void 0)})}}document.addEventListener("DOMContentLoaded",function(){var n=document.getElementById("createRoomBtn"),t=document.getElementById("joinRoomBtn"),o=document.getElementById("leaveRoomBtn"),s=document.getElementById("roomIdInput"),a=document.getElementById("roomIdDisplay"),c=document.getElementById("statusDisplay"),i=document.getElementById("googleAuthBtn"),u=document.getElementById("anonymousAuthBtn"),l=document.getElementById("signOutBtn"),d=document.getElementById("authStatus");function p(){return(p=r(e().m(function n(){var t,r;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,chrome.storage.local.get(["roomId","isConnected"]);case 1:return(t=e.v).roomId&&(a.textContent=t.roomId,a.style.display="block"),b(t.isConnected||!1,t.roomId),e.n=2,m();case 2:e.n=4;break;case 3:e.p=3,r=e.v,console.error("Error loading state:",r);case 4:return e.a(2)}},n,null,[[0,3]])}))).apply(this,arguments)}function m(){return f.apply(this,arguments)}function f(){return(f=r(e().m(function n(){var t,r;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,chrome.runtime.sendMessage({action:"getCurrentUser"});case 1:(t=e.v).success&&k(t.user),e.n=3;break;case 2:e.p=2,r=e.v,console.error("Error loading auth state:",r);case 3:return e.a(2)}},n,null,[[0,2]])}))).apply(this,arguments)}function y(){return(y=r(e().m(function t(){var r,o,s;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,n.disabled=!0,n.textContent="Creating...",r=Math.random().toString(36).substr(2,4).toUpperCase(),e.n=1,chrome.runtime.sendMessage({action:"createRoom",roomId:r});case 1:if(!(o=e.v).success){e.n=3;break}return e.n=2,chrome.storage.local.set({roomId:r,isConnected:!0});case 2:a.textContent=r,a.style.display="block",b(!0,r),console.log("Room created successfully:",r),e.n=4;break;case 3:throw new Error(o.error||"Failed to create room");case 4:e.n=6;break;case 5:e.p=5,s=e.v,console.error("Error creating room:",s),alert("Failed to create room: "+s.message);case 6:return e.p=6,n.disabled=!1,n.textContent="Create New Room",e.f(6);case 7:return e.a(2)}},t,null,[[0,5,6,7]])}))).apply(this,arguments)}function g(){return h.apply(this,arguments)}function h(){return(h=r(e().m(function n(){var r,o,c;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:if((r=s.value.trim().toUpperCase())&&4===r.length){e.n=1;break}return alert("Please enter a valid 4-character room code"),e.a(2);case 1:return e.p=1,t.disabled=!0,t.textContent="Joining...",e.n=2,chrome.runtime.sendMessage({action:"joinRoom",roomId:r});case 2:if(!(o=e.v).success){e.n=4;break}return e.n=3,chrome.storage.local.set({roomId:r,isConnected:!0});case 3:a.textContent=r,a.style.display="block",b(!0,r),s.value="",console.log("Joined room successfully:",r),e.n=5;break;case 4:throw new Error(o.error||"Failed to join room");case 5:e.n=7;break;case 6:e.p=6,c=e.v,console.error("Error joining room:",c),alert("Failed to join room: "+c.message);case 7:return e.p=7,t.disabled=!1,t.textContent="Join Room",e.f(7);case 8:return e.a(2)}},n,null,[[1,6,7,8]])}))).apply(this,arguments)}function v(){return(v=r(e().m(function n(){var t,r;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,o.disabled=!0,o.textContent="Leaving...",e.n=1,chrome.runtime.sendMessage({action:"leaveRoom"});case 1:if(!(t=e.v).success){e.n=3;break}return e.n=2,chrome.storage.local.remove(["roomId","isConnected"]);case 2:a.style.display="none",b(!1),console.log("Left room successfully"),e.n=4;break;case 3:throw new Error(t.error||"Failed to leave room");case 4:e.n=6;break;case 5:e.p=5,r=e.v,console.error("Error leaving room:",r),alert("Failed to leave room: "+r.message);case 6:return e.p=6,o.disabled=!1,o.textContent="Leave Room",e.f(6);case 7:return e.a(2)}},n,null,[[0,5,6,7]])}))).apply(this,arguments)}function b(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e&&n?(c.textContent="Connected to room ".concat(n),c.className="status connected",o.style.display="block"):(c.textContent="Not connected",c.className="status disconnected",o.style.display="none")}function k(e){if(e){var n=e.displayName||e.email||"Anonymous";d.textContent="Signed in as ".concat(n),d.className="status connected",d.style.display="block",i.style.display="none",u.style.display="none",l.style.display="block"}else d.textContent="Not signed in",d.className="status disconnected",d.style.display="block",i.style.display="block",u.style.display="block",l.style.display="none"}function w(){return(w=r(e().m(function n(){var t,r;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,i.disabled=!0,i.textContent="Signing in...",e.n=1,chrome.runtime.sendMessage({action:"signInWithGoogle"});case 1:if(!(t=e.v).success){e.n=3;break}return console.log("Google sign-in successful"),e.n=2,m();case 2:e.n=4;break;case 3:throw new Error(t.error||"Failed to sign in with Google");case 4:e.n=6;break;case 5:e.p=5,r=e.v,console.error("Error signing in with Google:",r),alert("Failed to sign in with Google: "+r.message);case 6:return e.p=6,i.disabled=!1,i.textContent="Sign in with Google",e.f(6);case 7:return e.a(2)}},n,null,[[0,5,6,7]])}))).apply(this,arguments)}function E(){return(E=r(e().m(function n(){var t,r;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,u.disabled=!0,u.textContent="Signing in...",e.n=1,chrome.runtime.sendMessage({action:"signInAnonymously"});case 1:if(!(t=e.v).success){e.n=3;break}return console.log("Anonymous sign-in successful"),e.n=2,m();case 2:e.n=4;break;case 3:throw new Error(t.error||"Failed to sign in anonymously");case 4:e.n=6;break;case 5:e.p=5,r=e.v,console.error("Error signing in anonymously:",r),alert("Failed to sign in anonymously: "+r.message);case 6:return e.p=6,u.disabled=!1,u.textContent="Continue as Guest",e.f(6);case 7:return e.a(2)}},n,null,[[0,5,6,7]])}))).apply(this,arguments)}function C(){return(C=r(e().m(function n(){var t,r;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,l.disabled=!0,l.textContent="Signing out...",e.n=1,chrome.runtime.sendMessage({action:"signOut"});case 1:if(!(t=e.v).success){e.n=3;break}return console.log("Sign-out successful"),e.n=2,m();case 2:e.n=4;break;case 3:throw new Error(t.error||"Failed to sign out");case 4:e.n=6;break;case 5:e.p=5,r=e.v,console.error("Error signing out:",r),alert("Failed to sign out: "+r.message);case 6:return e.p=6,l.disabled=!1,l.textContent="Sign Out",e.f(6);case 7:return e.a(2)}},n,null,[[0,5,6,7]])}))).apply(this,arguments)}!function(){p.apply(this,arguments)}(),n.addEventListener("click",function(){return y.apply(this,arguments)}),t.addEventListener("click",g),o.addEventListener("click",function(){return v.apply(this,arguments)}),i.addEventListener("click",function(){return w.apply(this,arguments)}),u.addEventListener("click",function(){return E.apply(this,arguments)}),l.addEventListener("click",function(){return C.apply(this,arguments)}),s.addEventListener("keypress",function(e){"Enter"===e.key&&g()})})})();